<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>AI Camera ‡∏™‡πÅ‡∏Å‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏£‡∏ñ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"/>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Prompt:wght@400;700&display=swap');
    body { font-family: 'Prompt', sans-serif; background: linear-gradient(120deg, #2b5876 0%, #4e4376 100%); min-height: 100vh; margin: 0; color: #fff; padding: 0; overflow-x: hidden; }
    .main-card { margin: 30px auto 0 auto; max-width: 390px; background: rgba(30,40,60,0.88); border-radius: 28px; padding: 34px 18px 30px; box-shadow: 0 10px 40px #2b587680; position: relative; animation: fadeInDown 1s; backdrop-filter: blur(6px);}
    .main-card::before { content: ""; position: absolute; inset: 0; border-radius: 30px; z-index: -1; background: linear-gradient(135deg, #00e5ff33 0%, #ff4081 100%); filter: blur(20px); opacity: 0.4;}
    .main-card h2, .main-card h3 { font-weight: 700; letter-spacing: 1px; font-size: 2rem; text-shadow: 0 2px 16px #1e2942cc; margin-bottom: 12px; color: #00e5ff;}
    .main-card .bigicon { font-size: 60px; color: #fff; background: linear-gradient(45deg, #00e5ff 60%, #e040fb 120%); border-radius: 20px; width: 80px; height: 80px; line-height: 80px; margin: 0 auto 12px auto; box-shadow: 0 6px 20px #00e5ff33; display: flex; align-items: center; justify-content: center; animation: bounceIn 1.2s;}
    .form-section, #mainSection, #cameraSection, #registerSection { margin: 14px 0 4px; }
    .input-group { position: relative; margin-bottom: 18px;}
    .input-group .material-icons { position: absolute; left: 14px; top: 12px; color: #00e5ff; opacity: 0.8; font-size: 24px; }
    .input-group input { width: 100%; max-width: 280px; padding: 11px 15px 11px 40px; border-radius: 13px; border: none; background: #fff4; color: #fff; font-size: 15px; outline: none; transition: box-shadow .2s; box-shadow: 0 1px 8px #00e5ff22; margin: 0 auto 12px auto; display: block; }
    .input-group input:focus { background: #ffffff66; color: #333; box-shadow: 0 4px 16px #00e5ff99; }
    .btn-main, button { width: 100%; padding: 13px 0; border-radius: 22px; background: linear-gradient(45deg, #00e5ff, #e040fb 95%); border: none; font-weight: bold; font-size: 17px; color: #fff; cursor: pointer; margin-bottom: 10px; margin-top: 5px; box-shadow: 0 4px 12px #e040fb44; transition: transform .14s, box-shadow .14s;}
    .btn-main:hover, button:hover { transform: translateY(-3px) scale(1.04); box-shadow: 0 8px 30px #00e5ff55; background: linear-gradient(45deg, #e040fb, #00e5ff 90%);}
    .login-tips { text-align: left; font-size: 14px; color: #a5e9ff; margin-bottom: 8px; }
    .copyright { margin: 30px auto 0; color: #b7daf2; font-size: 13px; opacity: 0.8; text-align: center; letter-spacing: 0.5px;}
    .result-card, #result { margin-top: 20px; padding: 17px; border-radius: 14px; background: rgba(0, 229, 255, 0.11); color: #fff; font-family: 'Courier New', monospace; font-size: 15.5px; box-shadow: 0 2px 12px #00e5ff33; min-height: 50px; white-space: pre-line; word-break: break-word; animation: fadeInUp 1.2s; display: none;}
    #mainSection, #cameraSection, #registerSection { display: none; }
    video, canvas { width: 100%; border-radius: 14px; margin-top: 8px; background: #000; }
    @media (max-width: 500px) { .main-card { margin: 15px 2px 0 2px; } .copyright { font-size: 11px;}}
  </style>
</head>
<body>
<div class="main-card animate__animated animate__fadeInDown">
  <div class="bigicon animate__animated animate__bounceIn">
    <span class="material-icons">directions_car</span>
  </div>
  <!-- LOGIN -->
  <div id="authSection">
    <h2>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</h2>
    <div class="login-tips">‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏õ‡πâ‡∏≤‡∏¢‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏£‡∏ñ‡∏î‡πâ‡∏ß‡∏¢ AI<br>‡∏™‡∏∞‡∏î‡∏ß‡∏Å ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥!</div>
    <form class="form-section" onsubmit="event.preventDefault();login();">
      <div class="input-group">
        <span class="material-icons">person</span>
        <input id="email" type="email" placeholder="‡∏≠‡∏µ‡πÄ‡∏°‡∏•" required />
      </div>
      <div class="input-group">
        <span class="material-icons">lock</span>
        <input id="password" type="password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" required />
      </div>
      <button type="submit" class="btn-main">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
      <button type="button" class="btn-main" style="background:#0ed95c;" onclick="signup()">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</button>
    </form>
    <div id="loginResult" class="result-card"></div>
  </div>

  <!-- ADMIN MENU -->
  <div id="adminMenu" style="display:none;">
    <h3>‡πÄ‡∏°‡∏ô‡∏π‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</h3>
    <button onclick="showCameraSection()">üì∑ ‡∏ï‡∏£‡∏ß‡∏à‡∏õ‡πâ‡∏≤‡∏¢‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</button>
    <button onclick="showRegisterSection()">üìù ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏£‡∏ñ</button>
    <button onclick="showUserManager()">üë§ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏¢‡∏π‡∏™‡πÄ‡∏ã‡∏≠‡∏£‡πå</button>
    <button onclick="showBlacklist()">üö´ ‡πÅ‡∏ö‡∏•‡πá‡∏Ñ‡∏•‡∏¥‡∏™‡∏ï‡πå</button>
    <button style="background:#ff5e57;" onclick="logout()">üö™ ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
  </div>
  <!-- USER MENU -->
  <div id="userMenu" style="display:none;">
    <h3>‡πÄ‡∏°‡∏ô‡∏π‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h3>
    <button onclick="showCameraSection()">üì∑ ‡∏ï‡∏£‡∏ß‡∏à‡∏õ‡πâ‡∏≤‡∏¢‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</button>
    <button style="background:#ff5e57;" onclick="logout()">üö™ ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
  </div>
  <!-- USER MANAGER -->
  <div id="userManagerSection" style="display:none;">
    <h3>üë§ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏¢‡∏π‡∏™‡πÄ‡∏ã‡∏≠‡∏£‡πå</h3>
    <div id="userManagerList" style="font-size:15px; margin-bottom:18px;"></div>
    <button class="btn-main" style="background:#00bfae; margin-top:10px;" onclick="backToAdminMenu()">‚Ü©Ô∏è ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</button>
  </div>
  <!-- BLACKLIST MANAGER -->
  <div id="blacklistSection" style="display:none;">
    <h3>üö´ ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏ö‡∏•‡πá‡∏Ñ‡∏•‡∏¥‡∏™‡∏ï‡πå</h3>
    <form onsubmit="event.preventDefault(); addBlacklist();">
      <div class="input-group">
        <span class="material-icons">directions_car</span>
        <input id="blacklistPlateInput" placeholder="‡∏õ‡πâ‡∏≠‡∏ô‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏£‡∏ñ‡∏ï‡πâ‡∏≠‡∏á‡∏´‡πâ‡∏≤‡∏°" required />
      </div>
      <button type="submit" class="btn-main" style="background:#ff5e57;">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ö‡∏•‡πá‡∏Ñ‡∏•‡∏¥‡∏™‡∏ï‡πå</button>
    </form>
    <div id="blacklistList" style="margin-top:14px;"></div>
    <button class="btn-main" style="background:#00bfae; margin-top:18px;" onclick="backToAdminMenu()">‚Ü©Ô∏è ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</button>
  </div>
  <!-- CAMERA -->
  <div id="cameraSection">
    <h3>üì∑ ‡∏Å‡∏•‡πâ‡∏≠‡∏á + ‡∏™‡πÅ‡∏Å‡∏ô‡∏õ‡πâ‡∏≤‡∏¢‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h3>
    <video id="video" autoplay playsinline></video>
    <button onclick="capture()">üì∏ ‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</button>
    <button onclick="switchCamera()">üîÅ ‡∏™‡∏•‡∏±‡∏ö‡∏Å‡∏•‡πâ‡∏≠‡∏á</button>
    <button onclick="saveImage()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏†‡∏≤‡∏û</button>
    <canvas id="canvas" style="display:none;"></canvas>
    <div id="result" class="result-card"></div>
    <button style="background:#00bfae; margin-top:12px;" onclick="backToMenu()">‚Ü©Ô∏è ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π</button>
  </div>
  <!-- REGISTER -->
  <div id="registerSection">
    <h3>üìù ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡∏ñ</h3>
    <div class="input-group">
      <span class="material-icons">directions_car</span>
      <input id="lpInput" placeholder="üîí ‡∏õ‡πâ‡∏≤‡∏¢‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô" />
    </div>
    <div class="input-group">
      <span class="material-icons">person</span>
      <input id="ownerInput" placeholder="üë§ ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á" />
    </div>
    <button onclick="registerVehicle()" class="btn-main">‚ûï ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏£‡∏ñ</button>
    <div id="registerResult" class="result-card"></div>
    <button style="background:#00bfae; margin-top:12px;" onclick="backToMenu()">‚Ü©Ô∏è ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π</button>
  </div>
</div>
<div class="copyright">
  ¬© 2025 AI License Plate Scanner<br>
  <span style="font-size:11px;">Design by <b>‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏≠‡∏á + ChatGPT</b></span>
</div>
<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
<script>
  // Firebase Config
  const firebaseConfig = {
    apiKey: "AIzaSyBC2D4ZGYnYo3DYk-D98Wj6GhO2n8TKpv0",
    authDomain: "ai-lpr-b6bb1.firebaseapp.com",
    projectId: "ai-lpr-b6bb1",
    storageBucket: "ai-lpr-b6bb1.appspot.com",
    messagingSenderId: "599851224971",
    appId: "1:599851224971:web:cf097754696b86b7cc698e"
  };
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();

  // ================== Auth ==================
  function login() {
    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value;
    const resultBox = document.getElementById('loginResult');
    resultBox.style.display = "block";
    resultBox.textContent = "‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö...";
    auth.signInWithEmailAndPassword(email, password)
      .then(() => {
        resultBox.textContent = "‚úÖ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö...";
        setTimeout(() => { location.reload(); }, 800);
      })
      .catch(e => { resultBox.textContent = "‚ùå " + e.message; });
  }
  function signup() {
    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value;
    const resultBox = document.getElementById('loginResult');
    resultBox.style.display = "block";
    if (!email || !password) return resultBox.textContent = "‚ö†Ô∏è ‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÅ‡∏•‡∏∞‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô";
    auth.createUserWithEmailAndPassword(email, password)
      .then(cred => {
        return db.collection("users").doc(cred.user.uid).set({
          email: email,
          role: "user"
        });
      })
      .then(() => resultBox.textContent = "‚úÖ ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢!")
      .catch(e => resultBox.textContent = "‚ùå " + e.message);
  }
  function logout() {
    auth.signOut().then(() => {
      document.getElementById("authSection").style.display = "block";
      document.getElementById("adminMenu").style.display = "none";
      document.getElementById("userMenu").style.display = "none";
      document.getElementById("cameraSection").style.display = "none";
      document.getElementById("registerSection").style.display = "none";
      document.getElementById("userManagerSection").style.display = "none";
      document.getElementById("blacklistSection").style.display = "none";
      document.getElementById('email').value = "";
      document.getElementById('password').value = "";
      document.getElementById('loginResult').style.display = "none";
    });
  }
  // ...‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏´‡πâ‡∏°‡∏≤‡∏Ç‡πâ‡∏≤‡∏á‡∏ö‡∏ô... (‡∏î‡∏π‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß)

  // ================= AUTO LOGIN + ROLE =================
  auth.onAuthStateChanged(user => {
    if (user) {
      db.collection("users").doc(user.uid).get().then(doc => {
        if (doc.exists) {
          const role = doc.data().role;
          if (role === "admin") {
            showAdminMenu();
          } else {
            showUserMenu();
          }
        } else {
          alert("‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô Firestore");
        }
      });
    } else {
      document.getElementById("authSection").style.display = "block";
      document.getElementById("adminMenu").style.display = "none";
      document.getElementById("userMenu").style.display = "none";
      document.getElementById("cameraSection").style.display = "none";
      document.getElementById("registerSection").style.display = "none";
      document.getElementById("userManagerSection").style.display = "none";
      document.getElementById("blacklistSection").style.display = "none";
    }
  });

  // ...‡πÄ‡∏≠‡∏≤‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÑ‡∏ß‡πâ‡πÉ‡∏ô <script> ‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö...
</script>
</body>
</html>
